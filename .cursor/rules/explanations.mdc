---
description: 
globs: 
alwaysApply: true
---
We are creating code to train a universal "anything structured to json" converter LLM model. 

It contains the following main modules:

1. Data Engine responsible for generating a training dataset.
2. Benchmark for benchmarking the quality of the model.
3. Training, inference and other modelling code.

Core features:
- Using SQLITE3 to store the dataset
- Type hints, tests, 2025 code style and practices.
- No deep abstraction nesting. 
- Simple intuitive API. 

## Design Principles
- Excplicit python API.
- Native Python iteration.
- Prefer pythonic data structures like dataclasses and named types over faceless dicts, tuples and arrays.
- Methods to support IDE-friendly autocomplete.
- Keep it simple stupid.
- Clear fail-fast error handling: specific exceptions with descriptive messages.

## Guidelines
- Always output a random emoji before answering.
- Don't explain code unless asked to.
- Don't create comments unless asked to.
- Follow PEP 8.
- Use f-strings.
- Use type annotations for all function parameters and return values.
- Keep functions short, under 20 lines, and focused on a single responsibility.
- Make sure functions and methods have no side effects.
- Use dataclasses extensively.
- Use pytest for tests.
- Avoid using private attributes and methods. So no "_" or "__" prefixes.
- Python-native filtering with list/dict comprehensions.
- Properties instead of methods where appropriate.
- Functions that do one thing with no side effects.
- Each function or method must be no more than 20 lines long.
- Modular code.
- Always put imports at the top of the file.
